<app-modal-header
  [description]="'configure a new ATM service endpoint and settings'"
  [title]="'Add new services'"
></app-modal-header>
<div class="content">
  <form [formGroup]="serviceForm" class="flex flex-col gap-5">
    <section
      class="flex w-full items-end justify-between gap-3"
      [ngClass]="{
        'items-center':
          serviceForm.get('serviceName')?.invalid &&
          serviceForm.get('serviceName')?.touched
      }"
    >
      <app-qr-input
        class="w-1/2"
        [label]="'Services Name'"
        [placeholder]="'ex. pay bills'"
        formControlName="serviceName"
        [controlName]="'serviceName'"
        [parentGroup]="serviceForm"
        [filled]="true"
        [required]="true"
      ></app-qr-input>
      <div class="flex items-center justify-between w-1/2 mb-2">
        <label>Enable Service </label>
        <nz-switch formControlName="isActive"></nz-switch>
      </div>
    </section>
    <section
      class="flex w-full gap-3 flex-col"
      [ngClass]="{ 'last-section': subServices.length < 1 }"
    >
      <div class="flex gap-3">
        <app-qr-select
          formControlName="serviceValueId"
          [controlName]="'serviceValueId'"
          [parentGroup]="serviceForm"
          [options]="types"
          [label]="'Services value'"
          [placeholder]="'select value'"
          [required]="true"
          class="w-1/3"
        ></app-qr-select>
        <app-qr-select
          formControlName="feesProfileId"
          [controlName]="'feesProfileId'"
          [parentGroup]="serviceForm"
          [options]="types"
          [label]="'Fees profile'"
          [placeholder]="'select fees'"
          [required]="true"
          class="w-1/3"
        ></app-qr-select>
        <app-qr-select
          formControlName="serviceTemplateId"
          [controlName]="'serviceTemplateId'"
          [parentGroup]="serviceForm"
          [options]="types"
          [label]="'Service template'"
          [placeholder]="'select template'"
          [required]="true"
          class="w-1/3"
        ></app-qr-select>
      </div>
    </section>
    <section
      class="flex w-full gap-4 last-section flex-col"
      formArrayName="subServices"
      *ngIf="subServices.length > 0"
    >
      <div
        *ngFor="let field of subServices.controls; let i = index"
        [formGroupName]="i"
        class="flex w-full gap-3 p-2 sub-group rounded-lg"
      >
        <app-qr-input
          [label]="'Sub services name'"
          [placeholder]="'ex. pay bills'"
          formControlName="serviceName"
          [controlName]="'serviceName'"
          [parentGroup]="field"
          [filled]="true"
          [required]="true"
          class="w-2/3"
        ></app-qr-input>
        <button
          class="delete flex gap-2 p-3 h-8 mt-9 justify-center items-center rounded-md"
          (click)="removeTemplate(i)"
        >
          <nz-icon nzType="delete" nzTheme="outline" style="color: #c90707" />
          Delete
        </button>

        <div class="flex items-center gap-1 h-24">
          <label>Active </label>
          <nz-switch formControlName="active"></nz-switch>
        </div>
      </div>
    </section>
  </form>
</div>
<app-modal-footer
  [submitText]="'Save & Submit'"
  [subText]="'add sub services'"
  (subSubmitted)="addTemplateField()"
  (isSubmitted)="submit()"
></app-modal-footer>
